[본캠프 58일차] 영속성
2025.5.16

## 영속성과 트랜잭션

---

### 1. 영속성(Persistence)
- 정의: 프로그램이 종료된 이후에도 데이터가 사라지지 않고 저장되는 성질.
- 비유: 메모리(휘발성 공간) 대신 디스크(비휘발성 저장소)에 데이터를 영구히 보존하는 것.
- 중요성: 데이터베이스에서의 데이터는 프로그램 종료 후에도 유지되어야 하므로, 영속성은 데이터베이스의 핵심 개념.

---

### 2. 영속성은 JPA의 개념이 아님
- 일반 개념: 영속성은 JPA나 Spring과 같은 특정 프레임워크에서 새로 생겨난 개념이 아님.
- 데이터베이스 관점: MySQL, Oracle, PostgreSQL 등 데이터베이스에 데이터를 저장하면 프로그램이 종료되어도 데이터는 남아있음.
- 상태 구분
  - 영속(Persistent): 데이터가 장기적으로 저장되는 상태.
  - 비영속(Transient): 자바 객체나 컬렉션에만 데이터를 담는 경우로, 프로그램 종료 시 데이터가 사라짐.

---

### 3. JPA에서의 영속성

- JPA의 역할: 자바 객체를 데이터베이스에 영속시키는 과정을 관리하는 라이브러리.
- 영속성 컨텍스트(Persistence Context): JPA가 엔티티 객체를 관리하는 메모리 영역.
- 영속 상태: `EntityManager`를 통해 영속성 컨텍스트에 등록된 객체는 영속 상태로 관리됨.
- 상태 구분
  - 영속(managed): `EntityManager`에 의해 관리되는 상태로, `find()`, `save()` 등을 통해 객체가 영속성 컨텍스트에 등록됨.
  - 비영속(new/transient): `EntityManager`에 의해 관리되지 않는 상태로, 객체가 영속성 컨텍스트에 등록되지 않음.
  - 준영속(detached): 한때 영속성 컨텍스트에 의해 관리되었으나, 현재는 관리되지 않는 상태.
  - 삭제(removed): 영속성 컨텍스트에서 제외되며, SQL 저장소에 `DELETE` 문을 저장하는 상태.
  - 반영(flush): 영속성 컨텍스트에 있는 변경 사항을 데이터베이스에 반영하는 과정으로, `commit` 전에 데이터베이스에 실제로 저장되지 않음.

---

### 4. 영속성 컨텍스트의 객체 관리

- EntityManager: 영속성 컨텍스트에 등록된 객체의 상태를 관리하는 주체.
- 기능
  - persist(): 새로운 엔티티를 영속성 컨텍스트에 등록.
  - merge(): 준영속 상태의 엔티티를 영속성 컨텍스트에 병합.
  - remove(): 영속성 컨텍스트에서 엔티티를 제거.
  - find(): 영속성 컨텍스트에서 엔티티를 조회.
  - flush(): 영속성 컨텍스트의 변경 사항을 데이터베이스에 반영.
